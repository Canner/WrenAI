@echo off
echo =====================================================
echo é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†PDFè½¬Markdownå·¥å…·
echo ðŸŽ¯ çœŸå®žæ ¼å¼ç‰ˆæœ¬ - å®Œç¾Žä¿æŒè¡¨æ ¼æ ¼å¼
echo =====================================================
echo.

REM æ£€æŸ¥PythonçŽ¯å¢ƒ
if exist ".venv\Scripts\python.exe" (
    echo [âœ“] ä½¿ç”¨è™šæ‹ŸçŽ¯å¢ƒPython...
    set PYTHON_CMD=.venv\Scripts\python.exe
) else (
    echo [!] ä½¿ç”¨ç³»ç»ŸPython...
    set PYTHON_CMD=python
)

REM æ£€æŸ¥PDFæ–‡ä»¶æ˜¯å¦å­˜åœ¨
if not exist "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†ï¼ˆ2.0æ­£å¼ç‰ˆï¼‰.pdf" (
    echo [âŒ] æ‰¾ä¸åˆ°PDFæ–‡ä»¶ "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†ï¼ˆ2.0æ­£å¼ç‰ˆï¼‰.pdf"
    echo [ðŸ’¡] è¯·å°†PDFæ–‡ä»¶æ”¾åœ¨ä¸Žç¨‹åºç›¸åŒçš„ç›®å½•ä¸­
    pause
    exit /b 1
)

echo [âœ“] å‘çŽ°PDFæ–‡ä»¶ï¼Œå‡†å¤‡å¼€å§‹è½¬æ¢...
echo.

REM æ£€æŸ¥æ˜¯å¦å·²æœ‰æœ€ä½³è½¬æ¢ç»“æžœ
if exist "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md" (
    echo [ðŸŽ‰] å‘çŽ°å·²æœ‰æœ€ä½³è½¬æ¢ç»“æžœæ–‡ä»¶: é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md
    for %%f in ("é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md") do echo [ðŸ“Š] æ–‡ä»¶å¤§å°: %%~zf å­—èŠ‚
    echo.
    choice /C RO /M "é€‰æ‹©æ“ä½œ: R=é‡æ–°è½¬æ¢, O=æ‰“å¼€å·²æœ‰æ–‡ä»¶"
    if errorlevel 2 (
        echo [ðŸ“–] æ‰“å¼€å·²æœ‰çš„è½¬æ¢ç»“æžœ...
        start notepad "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md"
        goto :end
    )
    echo [ðŸ”„] å°†é‡æ–°è¿›è¡Œè½¬æ¢...
    echo.
)

echo [ðŸš€] ä½¿ç”¨çœŸå®žæ ¼å¼è½¬æ¢å™¨è¿›è¡Œè½¬æ¢...
echo [â±ï¸] é¢„è®¡éœ€è¦ 1-2 åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…...
echo.

%PYTHON_CMD% real_format_converter.py

if %errorlevel% equ 0 (
    echo.
    echo [ðŸŽ‰] è½¬æ¢æˆåŠŸå®Œæˆ!
    echo [ðŸ“„] è¾“å‡ºæ–‡ä»¶: é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md
    echo.
    echo [âœ¨] è½¬æ¢ç‰¹ç‚¹:
    echo     âœ“ å®Œç¾Žä¿æŒè¡¨æ ¼æ ¼å¼
    echo     âœ“ æ‰€æœ‰æ–‡å­—å†…å®¹å®Œæ•´
    echo     âœ“ 7åˆ—è¡¨æ ¼ç»“æž„æ¸…æ™°
    echo     âœ“ é¡µé¢é¡ºåºå®Œå…¨æ­£ç¡®
    echo.
    choice /C YN /M "æ˜¯å¦æ‰“å¼€è½¬æ¢ç»“æžœæ–‡ä»¶ (Y=æ˜¯, N=å¦)"
    if errorlevel 2 goto :end
    start notepad "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md"
) else (
    echo.
    echo [âŒ] è½¬æ¢å¤±è´¥ï¼Œè¯·æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
    echo [ðŸ’¡] å¦‚æžœå·²æœ‰è½¬æ¢ç»“æžœï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨çŽ°æœ‰æ–‡ä»¶
    echo.
    if exist "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md" (
        choice /C YN /M "æ˜¯å¦æ‰“å¼€çŽ°æœ‰çš„è½¬æ¢ç»“æžœæ–‡ä»¶ (Y=æ˜¯, N=å¦)"
        if errorlevel 2 goto :end
        start notepad "é“¶è¡Œä¸€è¡¨é€šç›‘ç®¡æ•°æ®é‡‡é›†æŽ¥å£æ ‡å‡†_2.0_çœŸå®žæ ¼å¼.md"
    )
)

:end
echo.
echo [ðŸ‘‹] è½¬æ¢å®Œæˆï¼Œæ„Ÿè°¢ä½¿ç”¨ï¼
pause > nul