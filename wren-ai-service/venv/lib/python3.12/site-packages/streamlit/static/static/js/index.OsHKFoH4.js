import{r as s,E as W,_ as $,n as d,a4 as L,M as V,j as i,a8 as D,aX as K}from"./index.Phesr84n.js";import{I as N}from"./InputInstructions.ChC5isnC.js";import{i as _}from"./inputUtils.CQWz5UKz.js";import{T as M}from"./textarea.BE4J2P1T.js";import"./base-input.CSEcvcJD.js";var E=s.forwardRef(function(t,e){var l={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return s.createElement(W,$({iconAttrs:l,iconVerticalAlign:"middle",iconViewBox:"0 0 24 24"},t,{ref:e}),s.createElement("rect",{width:24,height:24,fill:"none"}),s.createElement("path",{d:"M3 5.51v3.71c0 .46.31.86.76.97L11 12l-7.24 1.81c-.45.11-.76.51-.76.97v3.71c0 .72.73 1.2 1.39.92l15.42-6.49c.82-.34.82-1.5 0-1.84L4.39 4.58C3.73 4.31 3 4.79 3 5.51z"}))});E.displayName="Send";const j=d("div",{target:"e4p0gdf0"})(({theme:t,width:e})=>({borderRadius:t.radii.default,display:"flex",backgroundColor:t.colors.widgetBackgroundColor??t.colors.secondaryBg,width:`${e}px`})),A=d("div",{target:"e4p0gdf1"})(({theme:t})=>({backgroundColor:t.colors.transparent,position:"relative",flexGrow:1,borderRadius:t.radii.default,display:"flex",alignItems:"center"})),F=d("button",{target:"e4p0gdf2"})(({theme:t,disabled:e,extended:l})=>{const u=L(t),[o,g]=u?[t.colors.gray60,t.colors.gray80]:[t.colors.gray80,t.colors.gray40];return{border:"none",backgroundColor:t.colors.transparent,borderTopRightRadius:l?"0":t.radii.default,borderTopLeftRadius:l?t.radii.default:"0",borderBottomRightRadius:t.radii.default,display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:t.lineHeights.none,margin:t.spacing.none,padding:t.spacing.sm,color:e?o:g,pointerEvents:"auto","&:focus":{outline:"none"},":focus":{outline:"none"},"&:focus-visible":{backgroundColor:u?t.colors.gray10:t.colors.gray90},"&:hover":{backgroundColor:t.colors.primary,color:t.colors.white},"&:disabled, &:disabled:hover, &:disabled:active":{backgroundColor:t.colors.transparent,borderColor:t.colors.transparent,color:t.colors.gray}}}),G=d("div",{target:"e4p0gdf3"})({display:"flex",alignItems:"flex-end",height:"100%",position:"absolute",right:0,pointerEvents:"none"}),U=d("div",{target:"e4p0gdf4"})(({theme:t})=>({position:"absolute",bottom:"0px",right:`calc(${t.iconSizes.xl} + 2 * ${t.spacing.sm} + ${t.spacing.sm})`})),O=6.5,H=1;function Z({width:t,element:e,widgetMgr:l,fragmentId:u}){const o=V(),[g,h]=s.useState(!1),[p,f]=s.useState(e.default),[b,C]=s.useState(0),a=s.useRef(null),y=s.useRef({minHeight:0,maxHeight:0}),R=()=>{let r=0;const{current:n}=a;if(n){const c=n.placeholder;n.placeholder="",n.style.height="auto",r=n.scrollHeight,n.placeholder=c,n.style.height=""}return r},x=()=>{a.current&&a.current.focus(),p&&(l.setStringTriggerValue(e,p,{fromUi:!0},u),h(!1),f(""),C(0))},w=r=>{const{metaKey:n,ctrlKey:c,shiftKey:z}=r;_(r)&&!z&&!c&&!n&&(r.preventDefault(),x())},k=r=>{const{value:n}=r.target,{maxChars:c}=e;c!==0&&n.length>c||(h(n!==""),f(n),C(R()))};s.useEffect(()=>{if(e.setValue){e.setValue=!1;const r=e.value||"";f(r),h(r!=="")}},[e]),s.useEffect(()=>{if(a.current){const{offsetHeight:r}=a.current;y.current.minHeight=r,y.current.maxHeight=r*O}},[a]);const{disabled:I,placeholder:m,maxChars:B}=e,{minHeight:T,maxHeight:S}=y.current,v=b>0&&a.current?Math.abs(b-T)>H:!1;return i(j,{className:"stChatInput","data-testid":"stChatInput",width:t,children:D(A,{children:[i(M,{inputRef:a,value:p,placeholder:m,onChange:k,onKeyDown:w,"aria-label":m,disabled:I,rows:1,overrides:{Root:{style:{minHeight:o.sizes.minElementHeight,outline:"none",backgroundColor:o.colors.transparent,borderLeftWidth:o.sizes.borderWidth,borderRightWidth:o.sizes.borderWidth,borderTopWidth:o.sizes.borderWidth,borderBottomWidth:o.sizes.borderWidth,width:`${t}px`}},InputContainer:{style:{backgroundColor:o.colors.transparent}},Input:{props:{"data-testid":"stChatInputTextArea"},style:{lineHeight:o.lineHeights.inputWidget,backgroundColor:o.colors.transparent,resize:"none","::placeholder":{opacity:"0.7"},height:v?`${b+H}px`:"auto",maxHeight:S?`${S}px`:"none",paddingLeft:o.spacing.sm,paddingBottom:o.spacing.sm,paddingTop:o.spacing.sm,paddingRight:`calc(${o.iconSizes.xl} + 2 * ${o.spacing.sm} + ${o.spacing.sm})`}}}}),t>o.breakpoints.hideWidgetDetails&&i(U,{children:i(N,{dirty:g,value:p,maxLength:B,type:"chat",inForm:!1})}),i(G,{children:i(F,{onClick:x,disabled:!g||I,extended:v,"data-testid":"stChatInputSubmitButton",children:i(K,{content:E,size:"xl",color:"inherit"})})})]})})}export{Z as default};
